{
	"$schema": "https://playground.wordpress.net/blueprint-schema.json",
	"landingPage": "/wp-admin/",
	"preferredVersions": {
		"php": "8.0",
		"wp": "latest"
	},
	"plugins": [
		"wordpress-importer",
		"woocommerce",
		"https://raw.githubusercontent.com/Micemade/playground/main/releases/mosaic-product-layouts-v.1.0.0.zip"
	],
	"steps": [
		{
			"step": "login"
		},
		{
			"step": "resetData"
		},
		{
			"step": "writeFile",
			"path": "/wordpress/wp-content/mu-plugins/rewrite.php",
			"data": "<?php /* Use pretty permalinks*/ add_action( 'after_setup_theme', function() { global $wp_rewrite; $wp_rewrite->set_permalink_structure('/%postname%/'); $wp_rewrite->flush_rules(); } );"
		},
		{
			"step": "installTheme",
			"themeData": {
				"resource": "wordpress.org/themes",
				"slug": "ollie"
			},
			"options": {
				"activate": true,
				"importStarterContent": true
			}
		},
		{
			"step": "importWxr",
			"file": {
				"resource": "url",
				"url": "https://raw.githubusercontent.com/Micemade/playground/main/WXR-imports/mpl-playground.xml"
			}
		},
		{
			"step": "runPHP",
			"code": "<?php include 'wordpress/wp-load.php'; delete_transient( '_wc_activation_redirect' );"
		},
		{
			"step": "runPHP",
			"code": "<?php\ninclude 'wordpress/wp-load.php';\n\n// Function to create product\nfunction create_product($title, $description, $price, $image_url) {\n    // Create product post\n    $product_id = wp_insert_post(array(\n        'post_title' => $title,\n        'post_content' => $description,\n        'post_status' => 'publish',\n        'post_type' => 'product'\n    ));\n\n    // Set product type to simple\n    wp_set_object_terms($product_id, 'simple', 'product_type');\n\n    // Set product data\n    update_post_meta($product_id, '_price', $price);\n    update_post_meta($product_id, '_regular_price', $price);\n    update_post_meta($product_id, '_manage_stock', 'no');\n    update_post_meta($product_id, '_stock_status', 'instock');\n    update_post_meta($product_id, '_virtual', 'no');\n    update_post_meta($product_id, '_downloadable', 'no');\n\n    // Download and attach image\n    if ($image_url) {\n        $upload = media_sideload_image($image_url, $product_id, '', 'id');\n        if (!is_wp_error($upload)) {\n            set_post_thumbnail($product_id, $upload);\n        }\n    }\n\n    return $product_id;\n}\n\n// Create products\n$products = array(\n    array(\n        'title' => 'Premium Headphones',\n        'description' => 'High-quality wireless headphones with noise cancellation.',\n        'price' => '199.99',\n        'image_url' => 'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/audio-monitor-01.jpg'\n    ),\n    array(\n        'title' => 'Smart Watch',\n        'description' => 'Feature-rich smartwatch with health monitoring.',\n        'price' => '249.99',\n        'image_url' => 'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/cosmetic-02.jpg'\n    ),\n    array(\n        'title' => 'Wireless Speaker',\n        'description' => 'Portable Bluetooth speaker with premium sound quality.',\n        'price' => '129.99',\n        'image_url' => 'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/footwear-02.jpg'\n    ),\n    array(\n        'title' => 'Gaming Mouse',\n        'description' => 'Ergonomic gaming mouse with customizable buttons.',\n        'price' => '79.99',\n        'image_url' => 'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/furniture-03.jpg'\n    )\n);\n\nforeach ($products as $product) {\n    create_product(\n        $product['title'],\n        $product['description'],\n        $product['price'],\n        $product['image_url']\n    );\n}\n\n// Create a page\n$page_id = wp_insert_post(array(\n    'post_title' => 'Our Products',\n    'post_content' => '<!-- wp:paragraph -->\n<p>Welcome to our product showcase. Here you can find our latest and greatest products.</p>\n<!-- /wp:paragraph -->\n\n<!-- wp:woocommerce/handpicked-products {\"columns\":4,\"contentVisibility\":{\"title\":true,\"price\":true,\"rating\":true,\"button\":true},\"orderby\":\"date\",\"products\":[]} /-->\n\n<!-- wp:paragraph -->\n<p>Feel free to browse through our collection and find the perfect product for you.</p>\n<!-- /wp:paragraph -->',\n    'post_status' => 'publish',\n    'post_type' => 'page'\n));\n\n// Set page as front page\nupdate_option('show_on_front', 'page');\nupdate_option('page_on_front', $page_id);"
		},
		{
			"step": "setSiteOptions",
			"options": {
				"blogname":"MPL playground",
				"woocommerce_store_city":"Rijeka",
				"woocommerce_store_address":"123 Main Street",
				"woocommerce_store_postcode":"51000",
				"woocommerce_default_country":"HR:HR-08",
				"woocommerce_onboarding_profile":{
					"skipped": true
				},
				"woocommerce_currency": "EUR",
				"woocommerce_weight_unit": "kg",
				"woocommerce_dimension_unit": "cm",
				"woocommerce_allow_tracking": "no",
				"woocommerce_cheque_settings": {
					"enabled": "yes"
				}
			}
		}
	]
}
