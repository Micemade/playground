{
	"$schema": "https://playground.wordpress.net/blueprint-schema.json",
	"landingPage": "/wp-admin/",
	"preferredVersions": {
		"php": "8.0",
		"wp": "latest"
	},
	"plugins": [
		"wordpress-importer",
		"woocommerce",
		"https://raw.githubusercontent.com/Micemade/playground/main/releases/mosaic-product-layouts-v.1.0.0.zip"
	],
	"steps": [
		{
			"step": "login"
		},
		{
			"step": "resetData"
		},
		{
			"step": "writeFile",
			"path": "/wordpress/wp-content/mu-plugins/rewrite.php",
			"data": "<?php /* Use pretty permalinks*/ add_action( 'after_setup_theme', function() { global $wp_rewrite; $wp_rewrite->set_permalink_structure('/%postname%/'); $wp_rewrite->flush_rules(); } );"
		},
		{
			"step": "installTheme",
			"themeData": {
				"resource": "wordpress.org/themes",
				"slug": "ollie"
			},
			"options": {
				"activate": true,
				"importStarterContent": true
			}
		},
		{
			"step": "writeFile",
			"path": "/wordpress/wp-content/mu-plugins/create-content.php",
			"data": "<?php\n// Check if content is already created\nif (!get_option('mpl_content_created')) {\n    // Function to create product\n    function create_product($title,$description,$price,$image_url){\n        $product_id=wp_insert_post(array('post_title'=>$title,'post_content'=>$description,'post_status'=>'publish','post_type'=>'product'));\n        wp_set_object_terms($product_id,'simple','product_type');\n        update_post_meta($product_id,'_price',$price);\n        update_post_meta($product_id,'_regular_price',$price);\n        update_post_meta($product_id,'_manage_stock','no');\n        update_post_meta($product_id,'_stock_status','instock');\n        update_post_meta($product_id,'_virtual','no');\n        update_post_meta($product_id,'_downloadable','no');\n        if($image_url){\n            $upload=media_sideload_image($image_url,$product_id,'','id');\n            if(!is_wp_error($upload)){\n                set_post_thumbnail($product_id,$upload);\n            }\n        }\n        return $product_id;\n    }\n\n    // Create products\n    $products=array(\n        array('title'=>'Premium Headphones','description'=>'High-quality wireless headphones with noise cancellation.','price'=>'199.99','image_url'=>'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/audio-monitor-01.jpg'),\n        array('title'=>'Smart Watch','description'=>'Feature-rich smartwatch with health monitoring.','price'=>'249.99','image_url'=>'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/cosmetic-02.jpg'),\n        array('title'=>'Wireless Speaker','description'=>'Portable Bluetooth speaker with premium sound quality.','price'=>'129.99','image_url'=>'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/footwear-02.jpg'),\n        array('title'=>'Gaming Mouse','description'=>'Ergonomic gaming mouse with customizable buttons.','price'=>'79.99','image_url'=>'https://raw.githubusercontent.com/Micemade/playground/main/media/mpl-playground/2024/11/furniture-03.jpg')\n    );\n\n    foreach($products as $product){\n        create_product($product['title'],$product['description'],$product['price'],$product['image_url']);\n    }\n\n    // Create page content\n    $page_content='<!-- wp:paragraph --><p>Welcome to our product showcase. Here you can find our latest and greatest products.</p><!-- /wp:paragraph -->';\n    if(class_exists('WC_Block_Registry')&&WC_Block_Registry::is_registered('woocommerce/handpicked-products')){\n        $page_content.='<!-- wp:woocommerce/handpicked-products --><div class=\"wp-block-woocommerce-handpicked-products\" data-columns=\"4\" data-orderby=\"date\"></div><!-- /wp:woocommerce/handpicked-products -->';\n    }else{\n        $page_content.='<!-- wp:shortcode -->[products limit=\"4\" columns=\"4\" orderby=\"date\"]<!-- /wp:shortcode -->';\n    }\n    $page_content.='<!-- wp:paragraph --><p>Feel free to browse through our collection and find the perfect product for you.</p><!-- /wp:paragraph -->';\n\n    // Create page\n    $page_args=array('post_title'=>'Our Products','post_content'=>$page_content,'post_status'=>'publish','post_type'=>'page');\n    $page_id=wp_insert_post($page_args,true);\n    if(!is_wp_error($page_id)&&$page_id>0){\n        update_option('show_on_front','page');\n        update_option('page_on_front',$page_id);\n    }\n\n    // Mark content as created\n    update_option('mpl_content_created', true);\n}"
		},
		{
			"step": "setSiteOptions",
			"options": {
				"blogname":"MPL playground",
				"woocommerce_store_city":"Rijeka",
				"woocommerce_store_address":"123 Main Street",
				"woocommerce_store_postcode":"51000",
				"woocommerce_default_country":"HR:HR-08",
				"woocommerce_onboarding_profile":{
					"skipped": true
				},
				"woocommerce_currency": "EUR",
				"woocommerce_weight_unit": "kg",
				"woocommerce_dimension_unit": "cm",
				"woocommerce_allow_tracking": "no",
				"woocommerce_cheque_settings": {
					"enabled": "yes"
				}
			}
		}
	]
}
